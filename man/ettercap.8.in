.\"  ettercap -- a multipurpose sniffer/interceptor utility
.\"
.\"  This program is free software; you can redistribute it and/or modify
.\"  it under the terms of the GNU General Public License as published by
.\"  the Free Software Foundation; either version 2 of the License, or
.\"  (at your option) any later version.
.\"
.\"  This program is distributed in the hope that it will be useful,
.\"  but WITHOUT ANY WARRANTY; without even the implied warranty of
.\"  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\"  GNU General Public License for more details.
.\"
.\"  You should have received a copy of the GNU General Public License
.\"  along with this program; if not, write to the Free Software
.\"  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
.\"
.\"  $Id: ettercap.8.in,v 1.13 2003/04/02 11:56:36 alor Exp $
.\"
.de Sp
.if n .sp
.if t .sp 0.4
..
.TH ETTERCAP "8" "" "ettercap @VERSION@"
.SH NAME
.B ettercap @VERSION@ 
\- A multipurpose sniffer/content filter for man in the middle attacks

.SH ***** IMPORTANT NOTE ******
Since ettercap NG (formerly 0.7.0) all the options have been changed. Even the target
specification have been changed. \fIPlease read carefully this man page.\fR

.SH SYNOPSIS
.B ettercap
[\fIOPTIONS\fR] [\fITARGET1\fR] [\fITARGET2\fR]
.PP
\fITARGET\fR is in the form \fIMAC/IPs/PORTs\fR
.br
where IPs and PORTs are range (e.g. /192.168.0.1-30,40,50/20,22,25)
.SH DESCRIPTION
Ettercap was born as a sniffer for switched LAN (and obviously even "hubbed" one),
but during the development process it has gained more and more features that have
changed it to a powerful and flexible tool for man-in-the-middle attacks.
It supports active and passive dissection of many protocols (even ciphered ones)
and includes many features for network and host analysis (such as OS fingerprint).
.PP
It has three sniffing methods:
.PP
\fICLASSIC\fR, classic sniffing method. You can choose to put or not the
interface in promisc mode (-p option). You will sniff only the network traffic
that reach your NIC.
.PP
\fIARPBASED\fR, uses arp poisoning to sniff in switched LAN between two or more
targets. It assumes various names depending on how many hosts are involved in
the poisoning.
.br
   - SIMPLE  XXX-TODO
.br
   - SMARTARP  XXX-TODO
.PP
\fIBRIDGED\fR, it uses two network interfaces and forward the traffic from one to the other
while performing sniffing and content filtering. This sniffing method is
totally stealthy since there is no way to find that someone is in the middle on
the cable.  XXX-TODO
.PP
The most relevant ettercap features are:
.PP
.B Characters injection in an established connection :
you can inject character to server (emulating commands) or to client (emulating replies)
maintaining the connection alive !!
.PP
.B SSH1 support :
you can sniff User and Pass, and even the data of an SSH1 connection. ettercap is the
first software capable to sniff an SSH connection in FULL-DUPLEX
.PP
.B HTTPS support :
you can sniff http SSL secured data... and even if the connection is made through a PROXY
.PP
.B Remote traffic sniffing through GRE tunnel:
you can sniff remote traffic through a GRE tunnel from a remote cisco router
and make mitm attack on it
.PP
.B Plug-ins support :
You can create your own plugin using the ettercap's API.
.PP
.B Password collector for :
TELNET, FTP, POP, RLOGIN, SSH1, ICQ, SMB, MySQL, HTTP, NNTP, X11, NAPSTER, IRC, RIP, BGP,
SOCKS 5, IMAP 4, VNC, LDAP, NFS, SNMP, HALF LIFE, QUAKE 3, MSN, YMSG (other protocols coming soon...)
.PP
.B Packet filtering/dropping:
You can set up a filter chain that search for a particular string (even hex) in the TCP
or UDP payload and replace it with yours or drop the entire packet.
.PP
.B Passive OS fingerprint:
you scan passively the lan (without sending any packet) and gather detailed info about
the hosts in the LAN: Operating System, running services, open ports, IP, mac address
and network adapter vendor.
.PP
.B OS fingerprint:
you can fingerprint the OS of the victim host and even its network adapter (it uses the
nmap (c) Fyodor database)
.PP
.B Kill a connection:
from the connections list you can kill all the connections you want
.PP
.B Packet factory:
You can create and sent packet forged on the fly. The factory let you to forge from Ethernet
header to application level.
.PP
.B Bind sniffed data to a local port
You can connect to that port with a client and decode unknown protocols or
inject data to it (only in arp based mode)


.SH TARGET SPECIFICATION
There is no concept of SOURCE nor DEST. The two target are intended to filter
traffic coming from one to the other and viceversa (since the connection is
bidirectional).
.PP
\fITARGET\fR is in the form \fIMAC/IPs/PORTs\fR. If you want you can omit any of its parts
and this will rappresent an ANY in that part. 
.br
e.g.
.br
"//80" means ANY mac address, ANY ip and ONLY port 80
.br
"/10.0.0.1/" means ANY mac address, ONLY ip 10.0.0.1 and ANY port
.PP
\fIMAC\fR must be unique and in the form 00:11:22:33:44:55
.PP
\fIIPs\fR is a range of IP in FQDN notation. You can specify range with the - (hyphen)
and single ip with , (comma). You can also use ; (semicolon) to indicate
different ip addresses.
.br
e.g.
.br
"10.0.0.1-5;10.0.1.33" expands into ip 10.0.0.1, 2, 3, 4, 5 and 10.0.1.33
.PP
\fIPORTs\fR is a range of PORTS. You can specify range with the - (hyphen) and single port 
with , (comma).
.br
e.g.
.br
"20-25,80,110" expands into ports 20, 21, 22, 23, 24, 25, 80 and 110
.PP
.B NOTE:
.br
you can reverse the matching of the TARGET by adding the -R option to the
command line. So if you want to sniff ALL the traffic BUT the one coming or
going to 10.0.0.1 you can specify "./ettercap -R /10.0.0.1/"
.PP
.B NOTE:
.br
When using content filtering engine, TARGET1 filters are applied on traffic
COMING FROM TARGET1 and not GOING TO it !
.br
Keep this in mind when appling content filters.
.PP


.SH PRIVILEDGES DROPPING
ettercap needs root priviledges to open the Link Layer sockets. After the
initialization phase the root privs are not needed anymore. So ettercap drop
them to UID = 65535 (nobody). Since ettercap have to write (create) log files,
it must be executed in a directory with the right permissions (e.g. /tmp/). If
you want to drop privs to a different uid, you can export the environment
variable EC_UID witht the value of the uid you want to drop the privs to (e.g.
export EC_UID=500). 



.SH OPTIONS
Options that make sense together can generally be combined. ettercap will warn the user
about unsupported option combinations.
.TP
.B SNIFFING OPTIONS
.PP
ettercap NG has a new unified sniffing method. This implies that ip_forwarding
in the kernel is always disabled and the forwarding is done by ettercap. Every
packet with destination mac address equal to the host's mac address and
destination ip address different for the one bound to the iface will be
forwarded by ettercap. Before forwarding them, ettercap can content filter,
sniff, log or drop them. It does not matter how these packet are hijacked,
ettercap will process them. You can even use external program to hijack
packet.
.br
You have full control of what ettercap should receive. You can use the internal
ARP poisoner, set the interface in promisc mode, use plugins or use every
method you want.
.TP
\fB\-A\fR, \fB\-\-arp-poison\fR
ARP BASED sniffing
.br
This option will activate the ARP poisoner. If you want to use the man-in-the-middle
technique you have to use it. You can use it in conjunction with other
hijacking method. The packet are forwarded (as always) at layer 3, so the kernel is
responsible for correct routing. 
.br
.B NOTE: 
if you manage to poison a client, you have to set correct routing
table in the kernel specifying the GW. If your routing table are incorrect, the
poisoned clients will not be able to navigate the Internet.
.br
Filters that have as action a replacement or a drop, can be used only with ARPBASED
sniffing because it is necessary to re-adjust the sequence number in full-duplex in order
to maintain the connection alive.
.TP
\fB\-B\fR, \fB\-\-bridge <IFACE>\fR
BRIDGED sniffing
.br
You need two network interfaces. ettercap will forward form one to the other
all the traffic it sees. It is useful for man in the middle at the phisical
layer. It is totally stealthy since it is passive and there is no way for an
user to see the attacker.
.br
You can content filter all the traffic as you were a transparent proxy for the
"cable".


.TP
.B OFF LINE SNIFFING
.TP
\fB\-r\fR, \fB\-\-read <FILE>\fR
OFF LINE sniffing 
.br
With this option enabled, ettercap will sniff packets from a pcap compatible
file instead of capturing from the wire.
.br
This is useful if you have a file dumped from tcpdump or ethereal and you want
to make an analysis (search for passwords or passive fingerprint) on it.
.br
Obviously you cannot use "active" sniffing (arp poisoning or bridging) while
sniffing from a file.
.TP
\fB\-d\fR, \fB\-\-dump <FILE>\fR
DUMP packet to a pcap file
.br
This is useful if you have to use "active" sniffing (arp poison) on a switched
LAN but you want to analyze the packets with tcpdump or ethereal. You can use
this option to dump the packets to a file and then load it into your favourite
application.


.TP
.B USER INTERFACES OPTIONS
.TP
\fB\-C\fR, \fB\-\-console\fR
The console interface, only printf ;)
.br
It is quite interactive, press 'h' in every moment to get the help of what you
can do.

.TP
\fB\-q\fR, \fB\-\-quiet\fR
Quiet mode. It can be used only in conjunction with the console interface. It
does not print packet content. It is useful if you want to convert pcap file to
ettercap log files.
.Sp
example:
.Sp
ettercap -Cq -L dumpfile -r pcapfile

.TP
\fB\-N\fR, \fB\-\-ncurses\fR
.br

.TP
\fB\-G\fR, \fB\-\-gtk\fR
.br

.TP
\fB\-D\fR, \fB\-\-daemonize\fR
.br
Daemonize ettercap. This option will detach ettercap from the current
controlling terminal and set it as a daemon. You can combine this feature with
the "log" option to log all the traffic in the background. If the daemon fail
for any reasons, it will create the file "./ettercap_daemonized.log" in
which is present the error caught by ettercap. Furthermore, if you want to have
a complete debug of the daemon process, you are encouraged to recompile
ettercap in debug mode.



.TP
.B GENERAL OPTIONS
.TP
\fB\-R\fR, \fB\-\-reverse\fR
Reverse the matching in the TARGET selection. It means not(TARGET). All but the
selected TARGET.

.TP
\fB\-t\fR, \fB\-\-proto <PROTO>\fR
Sniff only PROTO packets (default is TCP + UDP).
.br
This is useful if you want to select a port via the TARGET specification but
you want to differentiate between tcp or udp.
.br
PROTO can be "tcp", "udp" or "all" for both.

.TP
\fB\-P\fR, \fB\-\-plugin <PLUGIN>\fR
Run the selected PLUGIN. Many plugins need target specification, use TARGET as
always.
.br
In console mode (-C option), standalone plugin are executed and then the
application exits. Hook plugin are activated and the normal sniffing is
performed.
.br
To have a list of the available external plugins use "list" (without quotes) as
plugin name (e.g. ./ettercap -CP list).
.Sp
NOTE: you can also activate plugins directly from the interfaces (always press
"h" to get the inline help)
.Sp
More detailed info about plugins and about how to write your own are found in
the man page ettercap_plugin(8)

.TP
\fB\-L\fR, \fB\-\-log <LOGFILE>\fR
Log all the packet to binary files. These files can be parsed by etterlog(8) to
extract human readable data. With this option will be logged all the packets
that ettercap sniffs and all the passive info (host info + user & pass) it can
collect. Given a LOGFILE, ettercap will create LOGFILE.ecp (for packets) and
LOGFILE.eci (for the infos).
.br
NOTE: if you specify this option on command line you don't have to take care of
priviledges since the log file is opened in the startup phase (with high
privs). But if you enable the log option while ettercap is already started, you
have to be in a directory where uid = 65535 or uid = EC_UID can write.
.Sp
NOTE: the logfiles can be compressed with the deflate algorithm using the -c
option.

.TP
\fB\-l\fR, \fB\-\-log-info <LOGFILE>\fR
Very similar to -L but it logs only passive information + users and passwords
for each host. The file will be named LOGFILE.eci

.TP
\fB\-c\fR, \fB\-\-compress\fR
Compress the logfile with the gzip algorithm while it is dumped. etterlog(8) is
capable of handling both compressed and uncompresse log files.

.TP
\fB\-e\fR, \fB\-\-regex <REGEX>\fR
This option is useful in conjunction with -L. It logs only packets that match
the posiz regex REGEX.


.TP
.B STANDARD OPTIONS
.TP
\fB\-v\fR, \fB\-\-version\fR
Print the version and exit.

.TP
\fB\-h\fR, \fB\-\-help\fR
prints the help screen with a short summary of the available options.




.SH EXAMPLES
Here are some examples of using ettercap.
.TP
.B ettercap -Cp
.Sp
Use the console interface and do not put the interface in promisc mode. You
will see only your traffic.


.SH PLATFORMS
Linux 2.0.x  2.2.x  2.4.x
.br
FreeBSD 4.x 5.x
.br
OpenBSD 2.x 3.x
.br
NetBSD 1.5
.br
Mac OS X (darwin 1.3.x 1.4.x 5.x)
.br
Windows NT4  2000  XP


.SH AUTHORS
Alberto Ornaghi (ALoR) <alor@users.sourceforge.net>
.br
Marco Valleri (NaGA) <crwm@freemail.it>


.SH AVAILABILITY
http://ettercap.sourceforge.net/download/

.SH CVS
cvs -d:pserver:anonymous@cvs.ettercap.sf.net:/cvsroot/ettercap login
.br
cvs -d:pserver:anonymous@cvs.ettercap.sf.net:/cvsroot/ettercap co ettercap_ng

.SH BUGS
Our software never has bugs.
.br
It just develops random features.   ;)
.PP
.B KNOWN-BUGS
.PP
- It is better that you don't launch ettercap on a host that is a gateway
because man-in-the-middle attacks require to disable ip_forwarding, it may
cause problem with routing. But if you want to scan the LAN passively
the gateway is the right place to run ettercap... so be aware of what you
are doing.
.PP
- You cannot use plugins on yourself. outgoing link layer packets are not
captured by the same socket, so they will be ignored.
.PP
- While poisoning on a switched LAN, ettercap won't sniff the traffic made
by your host to others. the technical reason is: otherwise ettercap will
forward your packets two time (and this is not good...) the artistic
reason is: why sniffing yourself with a man-in-the-middle method ? use
simple sniffing instead ! ;)
.PP
- While sniffing in Public ARP mode, ettercap can "view" only one way of
the connection, so some protocol dissectors can fail...
.PP
- under X11 resizing the xterm can give a corrupted visualization of the
interface. SIGWINCH is *partially* supported.
.PP
- ettercap doesn't handle fragmented packets... only the first segment
will be displayed by the sniffer. However all the fragments are correctly
forwarded.
.PP
+ please send bug-report, patches or suggestions to <alor@users.sourceforge.net>
or visit http://ettercap.sourceforge.net/forum/  and post it in the BUGS section.
.PP
+ to report a bug, recompile ettercap with 'configure --enable-debug'
and attach ettercap_debug.log to the mail in which U explain the problem.


.SH FILOLOGICAL HISTORY
"Even if blessed with a feeble intelligence, they are cruel and smart..."
this is the description of Ettercap, a monster of the RPG Advanced Dungeons & Dragon.
Any process forked by ettercap has a name of a monster: illithid, doppleganger,
grell, dryad. Even the plugins (coded by us) are monsters.
.PP
The name "ettercap" was chosen because it has an assonance with "ethercap" which
means "ethernet capture" (what ettercap actually does) and also because such
monsters have a powerful poison... and you know, arp poisoning... ;)
.PP
Someone has mailed us :
.br
"Did you know that in Dutch "etter" means "pain in the ass" or "nasty piece
of work". Unfortunately, I think this applies to you, as this software will
be used by numerous script kiddies to hack all kinds of services on local
networks. "
.PP
I think that this is extremely true... ettercap is a "pain in the ass" for
admin-kiddie. There are many way to detect and to protect against ettercap....
The first one is: DON'T GIVE ROOT ACCESS TO SCRIPT-KIDDIES ON YOUR LAN!
Some features were limited intentionally to work only on local network, because
it is easier to protect against them locally.
.br
Internet is not a game, we need qualified admin and programmer to make secure
protocols and programs. It isn't our fault if the net is so insecure... but we
can do something to harden it.
Ettercap was developed with this idea in mind: if even a skript kiddies can do an
hijack of the local connections, probably someone will find a solution for that !

.SH The Lord Of The (Token)Ring
(the fellowship of the packet)
.PP
"One Ring to link them all, One Ring to ping them,
.br
 one Ring to bring them all and in the darkness sniff them."


